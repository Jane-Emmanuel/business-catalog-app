<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Business Catalog</title>
  <link rel="manifest" href="manifest.json">
  <style>
    body { font-family: Arial, sans-serif; background:#fff; margin:0; padding:0; }
    header { text-align: center; background:#000; color:#fff; padding:20px; position:relative; }
    #banner { width:100%; height:200px; object-fit:cover; background:#222; }
    #logo { width:80px; height:80px; border-radius:50%; object-fit:cover; border:2px solid #111; margin-top:-40px; background:#fff; }
    h1 { margin:10px 0; }
    #shop-description { font-style: italic; color:#ddd; }
    main { padding:20px; }
    .product { display:flex; align-items:center; justify-content:space-between; padding:8px; border-bottom:1px solid #ddd; }
    .product span { flex:1; cursor:pointer; }
    button { margin-left:10px; padding:5px 10px; border:none; cursor:pointer; background:#111; color:#fff; border-radius:4px; }
    button.delete { background:#d33; }
    form { margin:20px 0; display:flex; gap:10px; flex-wrap:wrap; }
    input { padding:5px; flex:1; }
    .editor-box { margin-top:20px; padding:10px; border:1px solid #ddd; border-radius:6px; }
  </style>
</head>
<body>

  <!-- Header Section -->
  <header>
    <img id="banner" src="" alt="Business Banner">
    <input type="file" id="banner-upload" accept="image/*">
    <br>
    <img id="logo" src="" alt="Business Logo">
    <input type="file" id="logo-upload" accept="image/*">
    <h1 id="business-name" contenteditable="true">Business Catalog</h1>
    <p id="shop-description" contenteditable="true">Showcase your products easily</p>
  </header>

  <!-- Example Storefront -->
  <main>
    <h2>Products</h2>

    <!-- WhatsApp number editor -->
    <div class="editor-box">
      <label for="whatsappInput">Seller WhatsApp Number:</label>
      <input type="text" id="whatsappInput" placeholder="e.g. 2348012345678">
      <button onclick="saveWhatsApp()">Save</button>
    </div>

    <!-- Product form -->
    <form id="add-product-form">
      <input type="text" id="product-name" placeholder="Product Name" required>
      <input type="text" id="product-price" placeholder="Price (e.g. $50)" required>
      <button type="submit">Add</button>
    </form>
    <ul id="product-list"></ul>
  </main>

  <script>
    let whatsappNumber = localStorage.getItem("whatsappNumber") || "2348012345678";

    // Load saved data from localStorage
    window.onload = () => {
      const savedBanner = localStorage.getItem("banner");
      const savedLogo = localStorage.getItem("logo");
      const savedName = localStorage.getItem("businessName");
      const savedDesc = localStorage.getItem("shopDesc");
      const savedProducts = JSON.parse(localStorage.getItem("products") || "[]");

      if (savedBanner) document.getElementById("banner").src = savedBanner;
      if (savedLogo) document.getElementById("logo").src = savedLogo;
      if (savedName) document.getElementById("business-name").innerText = savedName;
      if (savedDesc) document.getElementById("shop-description").innerText = savedDesc;
      if (whatsappNumber) document.getElementById("whatsappInput").value = whatsappNumber;

      renderProducts(savedProducts);
    };

    // Save WhatsApp
    function saveWhatsApp() {
      const num = document.getElementById("whatsappInput").value.trim();
      if(num) {
        whatsappNumber = num;
        localStorage.setItem("whatsappNumber", num);
        alert("WhatsApp number saved!");
      }
    }

    // Save banner
    document.getElementById("banner-upload").addEventListener("change", (e) => {
      const file = e.target.files[0];
      if (file) {
        const reader = new FileReader();
        reader.onload = function(evt) {
          document.getElementById("banner").src = evt.target.result;
          localStorage.setItem("banner", evt.target.result);
        };
        reader.readAsDataURL(file);
      }
    });

    // Save logo
    document.getElementById("logo-upload").addEventListener("change", (e) => {
      const file = e.target.files[0];
      if (file) {
        const reader = new FileReader();
        reader.onload = function(evt) {
          document.getElementById("logo").src = evt.target.result;
          localStorage.setItem("logo", evt.target.result);
        };
        reader.readAsDataURL(file);
      }
    });

    // Save business name
    document.getElementById("business-name").addEventListener("input", (e) => {
      localStorage.setItem("businessName", e.target.innerText);
    });

    // Save description
    document.getElementById("shop-description").addEventListener("input", (e) => {
      localStorage.setItem("shopDesc", e.target.innerText);
    });

    // Add product
    document.getElementById("add-product-form").addEventListener("submit", (e) => {
      e.preventDefault();
      const name = document.getElementById("product-name").value.trim();
      const price = document.getElementById("product-price").value.trim();
      if (name && price) {
        const products = JSON.parse(localStorage.getItem("products") || "[]");
        products.push({ name, price });
        localStorage.setItem("products", JSON.stringify(products));
        renderProducts(products);
        e.target.reset();
      }
    });

    // Render products
    function renderProducts(products) {
      const list = document.getElementById("product-list");
      list.innerHTML = "";
      products.forEach((p, index) => {
        const li = document.createElement("li");
        li.className = "product";
        li.innerHTML = `
          <span onclick="sendToWhatsApp('${p.name}')">${p.name} - ${p.price}</span>
          <button class="delete" onclick="deleteProduct(${index})">Delete</button>
        `;
        list.appendChild(li);
      });
    }

    // Delete product
    function deleteProduct(index) {
      let products = JSON.parse(localStorage.getItem("products") || "[]");
      products.splice(index, 1);
      localStorage.setItem("products", JSON.stringify(products));
      renderProducts(products);
    }

    // WhatsApp order
    function sendToWhatsApp(productName) {
      const msg = encodeURIComponent(`Hello, I'm interested in ${productName}`);
      window.open(`https://wa.me/${whatsappNumber}?text=${msg}`, "_blank");
    }
  </script>

</body>
</html>
